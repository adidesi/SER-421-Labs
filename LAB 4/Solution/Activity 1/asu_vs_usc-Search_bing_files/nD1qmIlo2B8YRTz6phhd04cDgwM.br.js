var TouchFiltercontrol;(function(n){function tt(){return n.tfilErrorMsg}function it(t){n.tfilErrorMsg=t}function a(){return n.tfils||(n.tfils=[]),n.tfils}function rt(){n.tfils=[]}function ut(n){n&&!ft(n)&&Lib.CssClass.add(n,"tfil-disable")}function ft(n){return n&&Lib.CssClass.contains(n,"tfil-disable")}function et(n){n&&Lib.CssClass.remove(n,"tfil-disable")}function h(n){n&&o(n)&&Lib.CssClass.remove(n,"tfil-hide")}function ot(n){n&&!o(n)&&Lib.CssClass.add(n,"tfil-hide")}function o(n){return n&&Lib.CssClass.contains(n,"tfil-hide")}function y(n){n&&!Lib.CssClass.contains(n,"tfil-navhide")&&Lib.CssClass.add(n,"tfil-navhide")}function p(n){n&&Lib.CssClass.remove(n,"tfil-navhide")}function st(n){return Lib.CssClass.contains(n,"tfil-active")}function r(n){return t(n,"appns")}function u(n){return t(n,"k")}function t(n,t,i){if(i===void 0&&(i=null),!n)return null;var r="data-"+t;return i===null?n.getAttribute(r):(n.setAttribute(r,i),i)}function i(n,i){return i===void 0&&(i=null),i===null?parseInt(t(n,c),10):(t(n,c,i.toString()),i)}function ht(n,t,i){var f,e;i===void 0&&(i=null);t&&(t.style.opacity="0",ot(t),f=_ge(t.id+"_head"),Log.Log("Hide","Tab","TouchFilter",!1,"AppNS",r(f),"K",u(f),"Category","CommonControls"));n&&(n.style.opacity="1",h(n),e=_ge(n.id+"_head"),Log.Log("Show","Tab","TouchFilter",!1,"AppNS",r(e),"K",u(e),"Category","CommonControls"));i&&i()}function ct(n){return t(n,f)?!0:!1}function w(n){var t=Math.abs(n);return t>400?5:t<=100?1:Math.ceil(t/100)}function at(n,t,i,r,u,f,e,o){var s=function(n,t,i,r,u,f,e,o){var s=a();(sj_evt.bind("ajax.unload",rt),s[n])||(it(t),s[n]=new v(n,i,r,u,f,e,o))};typeof SmartRendering!="undefined"?SmartRendering.LoadElementWhenDisplayed(this,_ge(n),s,[n,t,i,r,u,f,e,o]):s.apply(this,[n,t,i,r,u,f,e,o])}function vt(n){var t=a();for(var i in t)if(i.indexOf(n)===0)return t[i]}function yt(n,t){var i=vt(n);i&&i.swipeOnHeader(t)}var e="dataurl",b="nc",k="nr",f="al",d=10,c="tfilIndexName",s="b_tfil-ajaxLoad",g="tfil-ajaxCompleted",nt="tfil-ajaxError",l=function(){return _w.IsSearchAppXYFocusEnabled?!0:!1},v;typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});v=function(){function n(n,t,f,e,s,c,a){var v,k,it,rt,y,ut,p,g,ft,w,nt,et,b,tt,ot;if((this.id=n,this.rtl=t,this.horizontalSwipeThreshold=f,this.enableBleeding=e,this.isMultiGroup=s,this.baseUrl=c,this.updateScrollManually=a,this.kVal="",v=this,k=_ge(n),k)&&(v.container=k,v.head=v.container.firstElementChild,v.content=v.container.lastElementChild,e&&(v.content=v.container.lastChild.firstChild),it=Array.prototype.slice.call(v.head.getElementsByClassName("tfil-menu")),v.menuContainers=it.map(function(n){return n}),v.menus=v.menuContainers.map(function(n){return n.firstElementChild}),v.menuContainer=v.menuContainers[0],v.menu=v.menus[0],v.actives=[],v.styles=v.menuContainers.map(function(n){return n.appendChild(_d.createElement("style")),n.lastElementChild}),v.offsets=Array(v.menus.length),v.navLefts=Array(v.menus.length),v.navRights=Array(v.menus.length),v.header=_ge("b_header"),v.menuTotalHeight=v.menuContainer.clientHeight+d,rt=v.menu,rt)){for(y=0,ut=function(t){for(var e,s=function(){var n=t.children[f];st(n)&&(v.active=n,v.actives.push(n));i(n,f);v.bind(n);sj_be(n,"keydown",function(i){var r,u;i.keyCode===13?(v.click(n),n.focus()):i.keyCode===36?(i.preventDefault(),r=t.children[0],v.click(r),r.focus()):i.keyCode===35&&(i.preventDefault(),u=t.children[t.childElementCount-1],v.click(u),u.focus());l()&&(i.keyCode===37||i.keyCode===39)&&i.preventDefault()})},f=0;f<t.children.length;++f)s();sj_be(t.children[0],"transitionend",function(n){return v.onScrollEnd(n.target.parentElement)});v.navLefts[y]=_ge(n+"_navl_"+y);v.navRights[y]=_ge(n+"_navr_"+y);v.enableDrag(t,y);v.offsets[y]=0;e=parseInt(_w.getComputedStyle(t.firstElementChild,null).getPropertyValue("margin-right"));o(v.navLefts[y])&&t.scrollWidth-e>t.offsetWidth&&(h(v.navLefts[y]),h(v.navRights[y]),Lib.CssClass.add(v.menuContainers[y],"tfil-hasnav"));o(v.navLefts[y])||(sj_be(v.navLefts[y],"click",function(){var n=v.findClosestItemLeft(v.rtl?t.scrollLeft+t.offsetWidth:t.scrollLeft,t),f=v.rtl?n.left-t.scrollLeft-1:n.left+n.width-t.offsetWidth-t.scrollLeft+1;v.shift(f,!1,t);Log.Log(v.rtl?"NextChevron":"PrevChevron","TouchFilter","Nav",!1,"AppNS",r(v.navLefts[i(t)]),"K",u(v.navLefts[i(t)]),"Category","CommonControls")}),sj_be(v.navRights[y],"click",function(){var n=v.findClosestItemLeft(v.rtl?t.scrollLeft:t.scrollLeft+t.offsetWidth,t),f=v.rtl?n.left+n.width-t.offsetWidth-t.scrollLeft+1:n.left-t.scrollLeft-1;v.shift(f,!1,t);Log.Log(v.rtl?"PrevChevron":"NextChevron","TouchFilter","Nav",!1,"AppNS",r(v.navRights[i(t)]),"K",u(v.navRights[i(t)]),"Category","CommonControls")}));v.navstate(t,y);i(t,y++)},p=0,g=v.menus;p<g.length;p++)ft=g[p],ut(ft);if(this.initContent(),typeof Orientation!="undefined"&&Orientation&&Orientation.onOrientation)Orientation.onOrientation(function(n){Log.Log("Rotate","TouchFilter",n?"LS":"PT",!1,"Category","CommonControls")});for(sj_evt.bind("tfil_reload",function(n){n[1]===v.id&&v.loadAjaxData(v.active)}),v.container.addEventListener("tfil-reload",function(n){sj_sp(n);v.loadAjaxData(v.active)}),w=0,nt=v.menus;w<nt.length;w++)et=nt[w],v.captureAllTouchEvents(et);for(v.SetKVal(),y=0,b=0,tt=v.actives;b<tt.length;b++)ot=tt[b],v.shiftToItem(ot);sj_evt.fire("tfil_init_finished")}}return n.prototype.SetKVal=function(){var n=u(this.content);n=n.substring(0,n.indexOf("."));this.kVal=r(this.content)+"."+n},n.prototype.captureAllTouchEvents=function(n){["touchstart","touchmove","touchend","touchout"].forEach(function(t){sj_be(n,t,function(n){sj_sp(n)})})},n.prototype.nav=function(n){n===void 0&&(n=!1);var i=this,t=n===i.rtl?i.active.nextSibling:i.active.previousSibling;return(Log.Log(n?"NextTab":"PrevTab","TouchFilter","Nav",!1,"AppNS",r(t),"K",u(t),"Category","CommonControls"),t)?(i.click(t),t.focus(),!0):!1},n.prototype.headerOnMove=function(n,t){t===void 0&&(t=this.menu);var i=this,r=t.scrollLeft+n;i.shift(r,!0)},n.prototype.bind=function(n){var t=this;sj_be(n,"click",function(i){t.click(n);Log.Log("Select","Tab","TouchFilter",!1,"AppNS",r(n),"K",u(n),"Category","CommonControls");Swipe.StopEffect(i)})},n.prototype.click=function(n){var r=this,t=r.actives[i(n.parentElement)];n&&t!==n&&(t&&this.deactivate(t),this.activate(n),r.select(n))},n.prototype.activate=function(n){Lib.CssClass.add(n,"tfil-active");sj_evt.fire("tfilactive",this.id,i(n));n.setAttribute("aria-selected","true")},n.prototype.deactivate=function(n){Lib.CssClass.remove(n,"tfil-active");sj_evt.fire("tfildeactive",this.id,i(n));n.setAttribute("aria-selected","false")},n.prototype.select=function(n){var r=this,f=this.getActiveContentElement(),u;r.actives[i(n.parentElement)]=n;u=this.getActiveContentElement();ht(u,f,function(){sj_evt.fire("layoutChange",r.id,i(n))});t(n,e)&&!ct(u)&&r.loadAjaxData(n);r.shiftToItem(n);l()&&n.focus()},n.prototype.getActiveContentElement=function(n){n===void 0&&(n=!0);var r=this.actives.map(function(n){return t(n,"content")}).join("_"),i=_ge(r);return!i&&n&&(i=sj_ce("div",r),i.setAttribute("role","tabpanel"),this.content.appendChild(i)),i},n.prototype.initContent=function(){var n=this.getActiveContentElement(!1),i;n?t(n,f,"1"):(i=this.actives.map(function(n){return t(n,"content")}).join("_"),this.content.children.length===1&&this.content.children[0]instanceof HTMLDivElement&&this.content.children[0].id.indexOf("tfil_")===0?(n=this.content.children[0],n.id=i,t(n,f,"1"),n.setAttribute("role","tabpanel")):this.content.innerHTML='\n                    <div id="'+i+'" data-'+f+'="1" role="tabpanel">\n                        '+this.content.innerHTML+"\n                    <\/div>")},n.prototype.navstate=function(n,t){n===void 0&&(n=this.menu);var i=this;et(i.navRights[t]);(i.rtl&&n.scrollLeft===0||!i.rtl&&Math.ceil(n.scrollLeft)>=n.scrollWidth-n.offsetWidth)&&ut(i.navRights[t])},n.prototype.navHideState=function(n,t){n?p(this.navLefts[t]):y(this.navLefts[t])},n.prototype.navHideStateForDragging=function(n,t,i){if(t===void 0&&(t=this.menu),i===void 0&&(i=0),this.navLefts[i]&&this.navRights[i]){var r=this.navRights[i].offsetWidth,u=Math.abs(n)>r,f=this.navLefts[i]&&Lib.CssClass.contains(this.navLefts[i],"tfil-navhide");u||f?u&&f&&(t.scrollLeft+=this.rtl?-r:r,p(this.navLefts[i])):(t.scrollLeft+=this.rtl?r:-r,y(this.navLefts[i]))}},n.prototype.findClosestItemLeft=function(n,t){var c;t===void 0&&(t=this.menu);var f=t.children,s=this.rtl?t.lastChild:t.firstChild,a=this.rtl?t.firstChild:t.lastChild,h=s.offsetLeft,l=a.offsetLeft-h,e=parseInt(window.getComputedStyle(s).marginLeft),u={left:this.rtl?e:0,width:s.offsetWidth-(this.rtl?0:e)};if(n>=l)return u.left=l+(this.rtl?e:0),u;if(n<=0||f.length<=1)return u;for(var r=0,o=f.length-1,i=0;r<o;)i=(r+o)/2,i=this.rtl?Math.floor(i):Math.ceil(i),c=f[i].offsetLeft-h,c>n?this.rtl?r=i+1:o=i-1:c==n?r=o=i:this.rtl?o=i:r=i;return u.left=f[r].offsetLeft-h+(this.rtl?e:0),u.width=f[r].offsetWidth-(this.rtl?0:e),u},n.prototype.shiftToItem=function(n){var r=this,t=n.parentElement,i,u;t.scrollWidth<=t.offsetWidth||(i=n.offsetLeft-t.offsetWidth/2+n.offsetWidth/2,i-=r.rtl?t.lastChild.offsetLeft:t.firstChild.offsetLeft,u=i-t.scrollLeft,r.shift(u,!1,t))},n.prototype.shift=function(n,t,r){var s,h,c;t===void 0&&(t=!1);r===void 0&&(r=this.menu);var u=this,o=i(r),a=u.styles[o],f=r.scrollLeft,e=r.scrollWidth-r.offsetWidth,l=n+f;if(t){r.scrollLeft+=n;u.navHideState(u.rtl?Math.ceil(f)<e:f>0,o);u.navstate(r,o);return}Lib.CssClass.contains(r,"tfilmoving")||(s=!1,h=!1,l<=0?(n=-f,s=!0):Math.ceil(l)>=e&&(n=e-f,h=!0),c=u.rtl?!h:!s,u.navHideState(c,o),e=r.scrollWidth-r.offsetWidth,f=r.scrollLeft,c?c&&(u.rtl?s:h)&&(n=u.rtl?-f:e-f):n=u.rtl?e-f:-f,Math.abs(n)<=0)||(u.offsets[o]=n,a.innerHTML="#"+r.id+".tfilmoving .tfil-filter{transform:translateX("+-1*n+"px);}",Lib.CssClass.add(r,"tfilmoving"),Lib.CssClass.add(r,"sp_"+w(n)),this.updateScrollManually&&sb_st(function(){u.onScrollEnd(r)},100))},n.prototype.onScrollEnd=function(n){var t=i(n),r=this.offsets[t];Lib.CssClass.remove(n,"tfilmoving");Lib.CssClass.remove(n,"sp_"+w(r));n.scrollLeft+=r;this.navstate(n,t)},n.prototype.enableDrag=function(n,t){var i=this,r,u,f=!0,e=function(n){(Math.abs(n.pageX-r)>5||Math.abs(n.pageY-u)>5)&&(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation())},o=function(s){r=s.pageX;u=s.pageY;f&&(n.scrollWidth<=n.offsetWidth&&(sj_ue(_w,"mousedown",o,!0),sj_ue(_w,"click",e,!0)),f=!1);s.preventDefault&&s.preventDefault();var h=s.pageX,c=function(r){var u=r.pageX-h;n.scrollLeft-=u;h=r.pageX;i.navHideStateForDragging(i.rtl?Math.ceil(n.scrollLeft)-(n.scrollWidth-n.offsetWidth):n.scrollLeft,n,t)},l=function(){i.navstate(n,t);sj_ue(_w,"mousemove",c,!0);sj_ue(_w,"mouseup",l,!0)};sj_be(_w,"mousemove",c,!0);sj_be(_w,"mouseup",l,!0)};sj_be(n,"mousedown",o,!0);sj_be(n,"click",e,!0)},n.prototype.getUrlForMultigroup=function(){for(var u,r=this.baseUrl,i="",n=0;n<this.actives.length;++n)u=t(this.actives[n],e),i+=u,n<this.actives.length-1&&(i+="&");return r+((r.indexOf("?")!=-1?"&":"?")+i)},n.prototype.loadAjaxData=function(n){var f=this,r="",o,s,u;if(this.isMultiGroup)r=f.getUrlForMultigroup();else if(r=t(n,e),o=t(n.parentNode,e),o&&r[0]==="#")for(s=r.substr(1).split("#"),r=o,u=0;u<s.length;++u)r=r.replace(new RegExp("\\{"+u+"\\}","gm"),s[u]);this.loadAjaxDataHelper(n,r,function(t){sj_evt.fire("layoutChange",f.id,i(n));t&&sj_evt.fire("touchFilter_ajaxLoaded",f.id,i(n))})},n.prototype.loadAjaxDataHelper=function(n,i,r){if(r===void 0&&(r=null),i){var u=this.getActiveContentElement();if(Lib.CssClass.contains(u,s))return;u.setAttribute("aria-labelledby",n.id);Lib.CssClass.add(u,s);i+=(i.indexOf("?")!=-1?"&":"?")+"IID="+this.kVal+"&IG="+_G.IG;sj_ajax(i,{callback:function(n,i){if(n)Lib.CssClass.add(u,g),u.innerHTML="",i.appendTo(u),t(u,f,"1"),_w.rms&&_w.rms.start();else if(Lib.CssClass.add(u,nt),u.innerHTML=tt(),i&&i.request){var e=!i.request.getAllResponseHeaders();Log.Log("Error","TouchFilter",e?"Timeout":""+i.request.status,!1,"Category","CommonControls")}else Log.Log("Error","TouchFilter","AjaxError",!1,"Category","CommonControls");Lib.CssClass.remove(u,s);r&&r(n)},timeout:1e4})}},n.prototype.swipeOnHeader=function(n,t){if(t===void 0&&(t=0),!(t<0)&&!(t>=this.menus.length)){var i=this.menus[t];this.headerOnMove(n,i)}},n.prototype.selectTouchFilter=function(n,t){if(t===void 0&&(t=0),!(t<0)&&!(t>=this.menus.length)){var r=this.menus[t],i=r.children[n];i&&this.click(i)}},n}();n.init=at;n.swipeTouchFilterHeader=yt;typeof WireUp!="undefined"&&WireUp&&WireUp.init("tfil",function(n){if(n){var t=n.id;WireUp.onUpdate(n,"a",function(){sj_evt.fire("tfil_reload",t)})}});sj_evt.fire("tfil_init",n)})(TouchFiltercontrol||(TouchFiltercontrol={}))